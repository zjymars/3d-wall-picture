# 3D 建筑照片墙 - Vue 版本

这是一个基于 Vue 3 和 Three.js 的 3D 建筑照片墙应用，专门展示各种建筑外观设计。

## 功能特性

- 🏗️ **120张精选图片**: 从真实图片API获取，包含各种类型的精美图片
- 🏷️ **元数据标识**: 每张图片都通过API元数据进行了详细标识，包括图片组、描述、关键词等
- 🎨 **3D 滚动球状展示**: 从图库中选取部分图片进行3D球状展示，支持鼠标滚轮缩放和左键拖拽旋转
- 📱 **2D 照片瀑布墙**: 模仿专业图片库的瀑布流布局，支持不同尺寸图片的自然排列
- 🔍 **智能搜索**: 基于API元数据支持关键词搜索图片
- 📝 **图片描述模式**: 点击按钮显示图片的详细描述，文字加载在图片下方形成一体
- 🎛️ **交互控制**: 
  - 鼠标滚轮缩放（相机距离 10-100）
  - 左键拖拽旋转视角
  - 自动旋转和手动控制切换
- 📋 **侧边栏**: 图片列表和详细信息展示
- 📱 **响应式设计**: 支持移动端和桌面端
- 🎭 **视图切换**: 3D 和 2D 视图无缝切换
- 🔄 **API集成**: 实时从外部图片API获取数据，支持自动重试和备用方案

## 技术栈

- **前端框架**: Vue 3 + Composition API
- **状态管理**: Pinia
- **3D 渲染**: Three.js
- **构建工具**: Vite
- **开发语言**: TypeScript
- **样式**: CSS3 + 响应式设计
- **API集成**: ArcIns ImageToolkit 外部API
- **图片服务**: MinIO 文件存储服务

## 项目结构

```
src/
├── components/          # Vue 组件
│   ├── PhotoViz3D.vue  # 3D 图片可视化
│   ├── PhotoWall2D.vue # 2D 图片墙
│   ├── PhotoNode.vue   # 图片节点组件
│   └── Sidebar.vue     # 侧边栏组件
├── stores/             # Pinia 状态管理
│   └── photoStore.ts   # 图片相关状态
├── actions/            # 业务逻辑动作
│   └── photoActions.ts # 图片相关动作
├── services/           # API 服务
│   └── imageApi.ts     # 图片API客户端
├── App.vue             # 主应用组件
├── main.ts             # 应用入口
└── style.css           # 全局样式
```

## API 配置

### ArcIns ImageToolkit API

应用集成了 ArcIns ImageToolkit 外部API，用于获取真实的图片数据：

- **基础URL**: `http://192.10.222.123:8001/api/v1/external`
- **图片服务**: `http://192.10.222.123:9000` (MinIO)
- **认证**: 无需认证，只读访问
- **数据格式**: JSON

### 主要API接口

- `GET /image-groups` - 获取图片组列表
- `GET /image-groups/{id}/images` - 获取图片组中的图片
- `GET /images/{id}` - 获取单张图片详情
- `GET /stats` - 获取系统统计信息

### 图片数据来源

- 图片从多个图片组中随机选择
- 支持按关键词搜索相关图片
- 自动处理API连接失败的情况
- 提供备用图片方案

## 快速开始

### 安装依赖

```bash
npm install
```

### 开发模式

```bash
npm run dev
```

### 构建生产版本

```bash
npm run build
```

### 预览生产版本

```bash
npm run preview
```

## 使用说明

### 应用启动

1. **自动加载**: 应用启动时自动从API加载120张精选图片
2. **加载状态**: 显示加载进度和状态信息
3. **错误处理**: 如果API连接失败，自动使用备用图片
4. **重试机制**: 支持手动重试加载

### 3D 视图

- **部分图片展示**: 从图库中选取部分图片进行3D球状展示
- **鼠标滚轮**: 缩放视角（相机距离 10-100）
- **左键拖拽**: 旋转视角
- **自动旋转**: 松开鼠标后3秒自动恢复
- **切换布局**: 球形/网格布局
- **X-ray 模式**: 调整图片透明度

### 2D 视图

- **瀑布流布局**: 模仿专业图片库的瀑布流布局，支持不同尺寸图片的自然排列
- **网格布局**: 整齐的网格排列
- **列表布局**: 垂直列表展示
- **搜索过滤**: 按图片组、描述、关键词等搜索
- **排序功能**: 按日期、标题或类型排序

### 图片描述模式

- **描述按钮**: 每张图片都有描述按钮，点击后显示详细描述
- **一体化展示**: 描述文字加载在图片下方，与图片形成视觉一体
- **元数据展示**: 显示图片组、描述、关键词等元数据信息
- **动态加载**: 支持动态展开和收起描述内容

### 3D 部分图片展示

- **智能选择**: 从API图库中自动选取50张精选图片进行3D展示
- **性能优化**: 限制3D场景中的图片数量，确保流畅的交互体验
- **动态说明**: 实时显示当前3D场景中的图片数量和总图库数量
- **布局算法**: 改进的球形和网格分布算法，提供更好的视觉效果

### 搜索功能

- **API搜索**: 基于图片API的元数据进行精确搜索
- **关键词匹配**: 支持图片组名称、描述、关键词等字段搜索
- **智能匹配**: 自动从相关图片组中筛选匹配的图片
- **结果展示**: 动态显示搜索结果数量
- **重置功能**: 一键回到初始120张图片

### 侧边栏

- **图片列表**: 显示所有图片的缩略图
- **快速定位**: 点击图片快速定位到3D视图
- **高亮显示**: 当前选中图片高亮显示
- **元数据展示**: 显示图片组、描述、关键词等元数据信息

## 建筑类型

应用包含以下建筑类型：
- 现代建筑、古典建筑、摩天大楼
- 住宅建筑、商业建筑、文化建筑
- 宗教建筑、政府建筑、教育建筑
- 医疗建筑、交通建筑、工业建筑

## 建筑风格

支持多种建筑风格：
- 现代主义、后现代主义、新古典主义
- 哥特式、巴洛克、洛可可
- 文艺复兴、拜占庭、伊斯兰
- 中式、日式、欧式、美式

## 配置选项

### 布局模式
- `sphere`: 球形布局，建筑围绕中心点分布
- `grid`: 网格布局，建筑按行列排列

### 视图模式
- `3d`: 3D 可视化视图
- `2d`: 2D 建筑照片墙视图

### 显示选项
- `x-ray`: 启用 X-ray 模式，调整建筑透明度
- 相机距离: 调整 3D 视图的观察距离（10-100）
- 旋转速度: 控制自动旋转的速度

## 浏览器支持

- Chrome 80+
- Firefox 75+
- Safari 13+
- Edge 80+

## 开发说明

### 添加新功能
1. 在 `stores/photoStore.ts` 中添加新的状态
2. 在 `actions/photoActions.ts` 中添加相关动作
3. 在对应组件中实现 UI 交互

### 自定义样式
- 全局样式在 `src/style.css` 中定义
- 组件样式使用 `<style scoped>` 隔离
- 支持 CSS 变量和响应式设计

### 性能优化
- 使用 Vue 3 的响应式系统
- Three.js 场景优化和资源管理
- 建筑照片懒加载和缓存策略
- 根据照片数量动态调整3D布局

## 许可证

MIT License

## 贡献

欢迎提交 Issue 和 Pull Request！

## 更新日志

### v1.2.0
- 🔄 **API集成**: 集成ArcIns ImageToolkit外部API
- 🖼️ **真实图片**: 从API获取真实图片数据，替代模拟数据
- 🎯 **智能搜索**: 基于API元数据的真实搜索功能
- 🔄 **自动重试**: 支持API连接失败时的自动重试和备用方案
- 📱 **加载状态**: 完善的加载状态和错误处理UI
- 🏗️ **架构优化**: 重构代码结构，添加API服务层

### v1.1.0
- 新增120张建筑外观照片
- 添加鼠标滚轮缩放功能
- 实现左键拖拽旋转视角
- 优化3D场景布局算法
- 更新搜索结果为建筑主题

### v1.0.0
- 初始版本发布
- 支持 3D 和 2D 建筑展示
- 完整的搜索和过滤功能
- 响应式设计支持
